<!doctype html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-alpha.70">
<link rel="search" type="application/opensearchdescription+xml" title="AML" href="/opensearch.xml">
<script src="https://buttons.github.io/buttons.js"></script><title data-react-helmet="true">AMF Conversion | AML</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" name="docsearch:language" content="en"><meta data-react-helmet="true" name="docsearch:version" content="current"><meta data-react-helmet="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="AMF Conversion | AML"><meta data-react-helmet="true" name="description" content="The functionality expressed in this documentation is currently a work in progress."><meta data-react-helmet="true" property="og:description" content="The functionality expressed in this documentation is currently a work in progress."><meta data-react-helmet="true" property="og:url" content="https://aml-org.github.io/docs/related/amf_conversion"><link data-react-helmet="true" rel="shortcut icon" href="/img/logos/amlLogo.svg"><link data-react-helmet="true" rel="preconnect" href="https://BH4D9OD16A-dsn.algolia.net" crossorigin="anonymous"><link data-react-helmet="true" rel="canonical" href="https://aml-org.github.io/docs/related/amf_conversion"><link rel="stylesheet" href="/styles.fb97db39.css">
<link rel="stylesheet" href="/main.bb044ee0.css">
<link rel="preload" href="/styles.93fa50a3.js" as="script">
<link rel="preload" href="/runtime~main.77570002.js" as="script">
<link rel="preload" href="/main.42cbe68a.js" as="script">
<link rel="preload" href="/common.f6c72066.js" as="script">
<link rel="preload" href="/2.86439050.js" as="script">
<link rel="preload" href="/37.da5e16ec.js" as="script">
<link rel="preload" href="/40.8980a277.js" as="script">
<link rel="preload" href="/935f2afb.8a573342.js" as="script">
<link rel="preload" href="/17896441.54bdb81c.js" as="script">
<link rel="preload" href="/a2867a9b.9ba72644.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<nav aria-label="Skip navigation links"><button type="button" tabindex="0" class="skipToContent_11B0">Skip to main content</button></nav><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><div aria-label="Navigation bar toggle" class="navbar__toggle" role="button" tabindex="0"><svg aria-label="Menu" width="30" height="30" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></div><a class="navbar__brand" href="/"><img src="/img/logos/amlLogo.svg" alt="AML logo icon" class="themedImage_YANc themedImage--light_3CMI navbar__logo"><img src="/img/logos/amlLogo.svg" alt="AML logo icon" class="themedImage_YANc themedImage--dark_3ARp navbar__logo"><strong class="navbar__title"></strong></a><a class="navbar__item navbar__link" href="/docs/AML/aml">AML</a><a class="navbar__item navbar__link" href="/docs/AMF/amf_intro">AMF</a></div><div class="navbar__items navbar__items--right"><a href="https://www.npmjs.com/package/amf-client-js" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link header-npm-link" aria-label="npm link"></a><a href="https://github.com/aml-org/amf" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link header-github-link" aria-label="GitHub repository"></a><div class="react-toggle react-toggle--disabled displayOnlyInLargeViewport_2N3Q"><div class="react-toggle-track"><div class="react-toggle-track-check"><span class="toggle_3NWk">🌜</span></div><div class="react-toggle-track-x"><span class="toggle_3NWk">🌞</span></div></div><div class="react-toggle-thumb"></div><input type="checkbox" disabled="" aria-label="Dark mode toggle" class="react-toggle-screenreader-only"></div><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><div class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></div></button></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div><div class="navbar-sidebar"><div class="navbar-sidebar__brand"><a class="navbar__brand" href="/"><img src="/img/logos/amlLogo.svg" alt="AML logo icon" class="themedImage_YANc themedImage--light_3CMI navbar__logo"><img src="/img/logos/amlLogo.svg" alt="AML logo icon" class="themedImage_YANc themedImage--dark_3ARp navbar__logo"><strong class="navbar__title"></strong></a></div><div class="navbar-sidebar__items"><div class="menu"><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/docs/AML/aml">AML</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/AMF/amf_intro">AMF</a></li><li class="menu__list-item"><a href="https://www.npmjs.com/package/amf-client-js" target="_blank" rel="noopener noreferrer" class="menu__link header-npm-link" aria-label="npm link"></a></li><li class="menu__list-item"><a href="https://github.com/aml-org/amf" target="_blank" rel="noopener noreferrer" class="menu__link header-github-link" aria-label="GitHub repository"></a></li></ul></div></div></div></nav><div class="main-wrapper"><div class="docPage_vMrn"><div class="docSidebarContainer_3Ak5" role="complementary"><div class="sidebar_3gvy"><div class="menu menu--responsive thin-scrollbar menu_1yIk"><button aria-label="Open Menu" aria-haspopup="true" class="button button--secondary button--sm menu__button" type="button"><svg aria-label="Menu" class="sidebarMenuIcon_1CUI" width="24" height="24" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><ul class="menu__list"><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">AMF</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/AMF/amf_intro">What is AMF?</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/AMF/amf_support">AMFs supported Specs</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">Using AMF</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/AMF/using-amf/amf_setup">AMF project configuration</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/AMF/using-amf/amf_initialization">AMF initialization</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/AMF/using-amf/amf_parsing">Parsing with AMF</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/AMF/using-amf/amf_resolution">Resolution</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/AMF/using-amf/amf_validation">Validation</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/AMF/using-amf/amf_emission">Emission</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/AMF/using-amf/amf_model">AMF Model Resources</a></li></ul></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">AML</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/AML/aml">What is AML?</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/AML/aml_spec">AML Specification</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Customizable configurations</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/custom/resource_loaders">Custom resource loaders</a></li></ul></li><li class="menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#!">Related Docs</a><ul class="menu__list"><li class="menu__list-item"><a aria-current="page" class="menu__link menu__link--active active" tabindex="0" href="/docs/related/amf_conversion">AMF Conversion</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/related/async_raml_datatypes">Async + RAML Data Types in AMF</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/related/json_schema_draft_2019_09_to_draft_7">Json Schema Draft 2019-09 to Draft 7 Emission</a></li></ul></li></ul></div></div></div><main class="docMainContainer_2iGs"><div class="container padding-vert--lg docItemWrapper_1bxp"><div class="row"><div class="col docItemCol_U38p"><div class="docItemContainer_a7m4"><article><header><h1 class="docTitle_Oumm">AMF Conversion</h1></header><div class="markdown"><div class="admonition admonition-caution alert alert--warning"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>caution</h5></div><div class="admonition-content"><p>The functionality expressed in this documentation is currently a work in progress.
If any bugs are found that do not satisfy these functionalities,
please file an issue in the <a href="https://github.com/aml-org/amf/issues" target="_blank" rel="noopener noreferrer">amf repository</a>.</p></div></div><h1><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="what-is-webapis-conversion"></a>What is WebAPIs conversion?<a class="hash-link" href="#what-is-webapis-conversion" title="Direct link to heading">#</a></h1><p>Conversion stands for the capability of parsing a <a href="https://github.com/aml-org/amf/blob/develop/documentation/model.md#webapi" target="_blank" rel="noopener noreferrer"><strong>WebAPI</strong></a> from one specification vendor into an API graph and then rendering said graph as a different vendor&#x27;s specification.
It&#x27;s a <em>cross parsing-rendering process</em> from a source spec to a different target spec.</p><p>Different specifications can have different required fields, and the same information conceptually may not be described in the same way.
This is why the AMF graph needs to go through a transformation process called <em>“Compatibility resolution”</em>.</p><p><a href="/docs/AMF/using-amf/amf_resolution#pipelines"><strong>Compatibility resolution</strong></a> is a specific resolution pipeline that is used to adapt an API graph parsed from one spec (source),
to fulfill the requirements of another spec in which it will be rendered (target).
An example of how to use Compatibility Resolution can be seen in <a href="#conversion-examples">Example 1</a>.</p><p>How does this impact the API model? For example, fields that are not required in the origin spec but required in the target spec,
will be added with default values if they are not present in the origin spec.</p><div class="admonition admonition-tip alert alert--success"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="16" viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>The Objective</h5></div><div class="admonition-content"><p>The objective of conversion is to <strong>output a valid AMF model for the spec in which it will be rendered</strong>.
It aims to <strong>keep information loss to a minimum through a best-effort process</strong> with some limitations.</p></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="conversion-goals"></a>Conversion Goals<a class="hash-link" href="#conversion-goals" title="Direct link to heading">#</a></h2><p>Conversion resolution has several goals:</p><ul><li>Make transitioning to/from OAS to RAML easier for the end user</li><li>Give the user an approximate view of what their API in another spec would look like</li><li>Let tools use specs that they don&#x27;t directly support</li><li>Take advantage of spec-specific tooling<ul><li>for example, converting to OAS to use <a href="https://swagger.io/tools/swagger-ui" target="_blank" rel="noopener noreferrer">swagger-ui</a> in a microservice or using a trusted client-spec generator that only works with RAML</li></ul></li></ul><h1><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="conversion-limitations"></a>Conversion limitations<a class="hash-link" href="#conversion-limitations" title="Direct link to heading">#</a></h1><p>The AMF team, having listened to other team&#x27;s needs, is the one that dictates how the model is adapted to fit other specs:</p><ul><li>If there is 1:1 information type mapping between specs it will be converted</li><li>If there are missing mandatory fields, a default value will be added
The default&#x27;s value is opinionated, meaning that there may be more than one possible value, and we choose which one we use</li><li>Anything else is omitted</li></ul><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="concepts-present-in-a-spec-but-nonexistent-in-another-arent-supported"></a>Concepts present in a spec but nonexistent in another aren&#x27;t supported<a class="hash-link" href="#concepts-present-in-a-spec-but-nonexistent-in-another-arent-supported" title="Direct link to heading">#</a></h3><p>Sometimes a spec may introduce concepts that don&#x27;t exist in other specs. There are many cases coming from RAML to OAS, some are:</p><ul><li>Datatype Fragments</li><li>Libraries</li><li>Resource Types and Traits</li><li>Overlays and Extensions</li></ul><p>These concepts cannot be converted to OAS as they do not exist in that spec.
These constructs can be migrated to OAS if and only if they are referenced from a root Api document.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="not-all-specs-are-supported"></a>Not all specs are supported<a class="hash-link" href="#not-all-specs-are-supported" title="Direct link to heading">#</a></h3><p>As a consequence of the previous limitation, not all specs can be converted between each other. Currently, Async API is not supported for conversion.
Its event-led concepts don&#x27;t have a direct correspondence to REST concepts described in RAML or OAS.
For example, how would an Async APIs <code>subscribe</code> or <code>binding</code> be in RAML? The amount of similar concepts is simply not enough to create similar graphs.</p><p>Supported conversions are:</p><ul><li>RAML 1.0 to OAS 2.0 and vice-versa</li><li>RAML 1.0 to OAS 3.0 and vice-versa</li></ul><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="information-may-be-lost"></a>Information may be lost<a class="hash-link" href="#information-may-be-lost" title="Direct link to heading">#</a></h3><p>Original information that is incompatible with the target spec may be lost.
This is also a consequence of having concepts present in source spec that don&#x27;t exist in the target spec.
For example OAS 3 links have no way of being migrated into RAML and will not be rendered in the converted RAML spec.</p><p>In the next example, not all the RAML  <code>documentation</code> nodes can be migrated to OAS 3.0 <code>externalDocs</code> nodes.
In fact, only the first <code>documentation</code> node is kept while the others are lost.
As the RAML 1.0 <code>documentation</code> does not define an url like OAS 3.0&#x27;s does, an url node is defined with an “empty” url.</p><div class="mdxCodeBlock_1zKU"><div style="color:#393A34;background-color:#f6f8fa" class="codeBlockTitle_2eSY">RAML to OAS 3.0 documentation conversion example - RAML code</div><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-yaml codeBlock_tuNs thin-scrollbar codeBlockWithTitle_1UkA"><div class="codeBlockLines_3uvA" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token key atrule" style="color:#00a4db">documentation</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">title</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> Test Console and Mocking Service</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">content</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">|</span><span class="token scalar string" style="color:#e3116c"></span></div><div class="token-line" style="color:#393A34"><span class="token scalar string" style="color:#e3116c">        Welcome to the \_Test API\_ Documentation. The \_Test API\_</span></div><div class="token-line" style="color:#393A34"><span class="token scalar string" style="color:#e3116c">        allows you to test console and mocking service features</span></div><div class="token-line" style="color:#393A34"><span class="token scalar string" style="color:#e3116c">        [integration libraries](https://mulesoft.com)</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">title</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> Legal</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">content</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token tag" style="color:#00009f">!include</span><span class="token plain"> docs/api.md</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><div class="mdxCodeBlock_1zKU"><div style="color:#393A34;background-color:#f6f8fa" class="codeBlockTitle_2eSY">RAML to OAS 3.0 documentation conversion example - OAS code</div><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-yaml codeBlock_tuNs thin-scrollbar codeBlockWithTitle_1UkA"><div class="codeBlockLines_3uvA" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token key atrule" style="color:#00a4db">externalDocs</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">url</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> http</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">//</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">description</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">|</span><span class="token scalar string" style="color:#e3116c"></span></div><div class="token-line" style="color:#393A34"><span class="token scalar string" style="color:#e3116c">        Welcome to the \_Test API\_ Documentation. The \_Test API\_</span></div><div class="token-line" style="color:#393A34"><span class="token scalar string" style="color:#e3116c">        allows you to test console and mocking service features</span></div><div class="token-line" style="color:#393A34"><span class="token scalar string" style="color:#e3116c">        [integration libraries](https://mulesoft.com)</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="default-conversion-is-not-customizable"></a>Default conversion is not customizable<a class="hash-link" href="#default-conversion-is-not-customizable" title="Direct link to heading">#</a></h3><p>Each spec conversion is implemented as a different <a href="/docs/AMF/using-amf/amf_resolution"><em>Resolution Pipeline</em></a>, and provided pipelines are not modifiable.
Thus, the provided default conversion functionality is not customizable.
However, a different conversion resolution can be implemented by creating a new <em>ResolutionPipeline</em> with the required conversion stages.</p><p>We know and understand that the same API can be modeled and emitted in different ways following different practices, but it&#x27;s not possible to cover them all.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="round-trip-conversions"></a>Round-trip conversions<a class="hash-link" href="#round-trip-conversions" title="Direct link to heading">#</a></h3><p>When AMF adapts a model graph to be able to render it in another spec, it knows from which spec the model was parsed (spec A) and to which spec the model will be rendered (spec B).
After the model is rendered that knowledge is lost as that file is just another API from spec B.
This context loss makes it impossible to convert back again from spec B to spec A and expect exactly the same content.</p><p>Previously, AMF attempted to reduce this information lost in conversion by rendering constructs that could only be parsed by them.
This was often done with special API constructs given by the specs and recognized by AMF:</p><ul><li><a href="https://github.com/raml-org/raml-spec/blob/master/versions/raml-10/raml-10.md#annotations" target="_blank" rel="noopener noreferrer"><em>annotations</em></a> in RAML, written as <code>amf-.*</code></li><li><a href="https://github.com/OAI/OpenAPI-Specification/blob/master/versions/3.0.0.md#specification-extensions" target="_blank" rel="noopener noreferrer"><em>specification extensions</em></a> in OpenApi, written as <code>x-amf-.*</code></li></ul><p>These attempts to keep as much information possible have two main drawbacks:</p><ul><li>AMF can&#x27;t know whether some content in the rendered spec, like annotations, was rendered for compatibility purposes, or it is something that a spec author wanted to have in the spec</li><li>All recognizable attributes that AMF can write in the spec to identify it as coming from a compatibility context can be emulated by a spec designer with a modeling intention and are therefore invalid as conversion identifiers</li></ul><h1><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="common-questions"></a>Common Questions<a class="hash-link" href="#common-questions" title="Direct link to heading">#</a></h1><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="why-dont-we-use-annotations-to-render-incompatible-content"></a>Why don&#x27;t we use annotations to render incompatible content?<a class="hash-link" href="#why-dont-we-use-annotations-to-render-incompatible-content" title="Direct link to heading">#</a></h3><p>Incompatible content isn&#x27;t rendered in an annotation because it goes against one of the goals of conversion: take advantage of tooling in a specific spec.
Annotation-rendered incompatible content will not be processed by tooling with the intent it was added to the spec, thus rendering that content useless.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="why-have-some-items-in-the-spec-lost-their-relative-order"></a>Why have some items in the spec lost their relative order?<a class="hash-link" href="#why-have-some-items-in-the-spec-lost-their-relative-order" title="Direct link to heading">#</a></h3><p>AMF doesn&#x27;t guarantee that items keep their relative order. The framework does a best-effort of keeping order by reusing the spec&#x27;s lexical information.
API resolution may sometimes make that lexical information useless or meaningless due to several operations that it performs.
This is significant especially in conversion where fields may be added, removed or transformed.</p><p>Why doesn&#x27;t AMF guarantee relative order? AMF&#x27;s underlying model is a directed cyclic graph.
In a graph, outgoing edges from a vertex aren&#x27;t ordered relatively as the only thing that matters is where those edges go, not how they are ordered. The same applies to AMF&#x27;s model.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="can-i-parse-and-render-my-api-from-a-spec-to-the-same-one"></a>Can I parse and render my API from a spec to the same one?<a class="hash-link" href="#can-i-parse-and-render-my-api-from-a-spec-to-the-same-one" title="Direct link to heading">#</a></h3><p>You shouldn&#x27;t resolve the model with a compatibility pipeline as these pipelines are just to move between different specifications.</p><p>To render to the same specification you shouldn&#x27;t apply a resolution unless you want the model to also be resolved (apply traits, resource types, apply inheritance and links, solve parameters, etc).</p><p>Although you can cycle (parse and render) your API using AMF you should reconsider why you are doing it and see if the framework has the capabilities of achieving what you seek in a different, more useful way.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="why-do-i-have-to-use-conversion-resolution-cant-renderers-know-how-to-render-correctly"></a>Why do I have to use conversion resolution? Can&#x27;t Renderers know how to render correctly?<a class="hash-link" href="#why-do-i-have-to-use-conversion-resolution-cant-renderers-know-how-to-render-correctly" title="Direct link to heading">#</a></h3><p>Rendering has to render any model that is passed to the Renderers, it can&#x27;t modify said model.
This is why conversion is done in a resolution stage (using a specific pipeline for compatibility), it is the only place where the model can be transformed before rendering.</p><h1><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="conversion-examples"></a>Conversion Examples<a class="hash-link" href="#conversion-examples" title="Direct link to heading">#</a></h1><div class="mdxCodeBlock_1zKU"><div style="color:#393A34;background-color:#f6f8fa" class="codeBlockTitle_2eSY">Example 1. Conversion from RAML 1.0 to OAS 2.0 (Java)</div><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-java codeBlock_tuNs thin-scrollbar codeBlockWithTitle_1UkA"><div class="codeBlockLines_3uvA" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">AMF</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">init</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">get</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token class-name">BaseUnit</span><span class="token plain"> ramlApi </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">new</span><span class="token plain"> </span><span class="token class-name">RamlParser</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">parseFileAsync</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;&lt;your-converted-api-file-path&gt;&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">get</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token class-name">Resolver</span><span class="token plain"> resolver </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">new</span><span class="token plain"> </span><span class="token class-name">Oas20Resolver</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token class-name">BaseUnit</span><span class="token plain"> convertedOasApi </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> resolver</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">resolve</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">ramlApi</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token class-name">ResolutionPipeline</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">COMPATIBILITY_PIPELINE</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token class-name">Renderer</span><span class="token plain"> renderer </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">new</span><span class="token plain"> </span><span class="token class-name">Oas20Renderer</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">renderer</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">generateFile</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">convertedOasApi</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;&lt;your-converted-api-file-path&gt;&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">get</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><div class="mdxCodeBlock_1zKU"><div style="color:#393A34;background-color:#f6f8fa" class="codeBlockTitle_2eSY">Example 2. Custom ResolutionPipeline creation (Java)</div><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-java codeBlock_tuNs thin-scrollbar codeBlockWithTitle_1UkA"><div class="codeBlockLines_3uvA" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">class</span><span class="token plain"> </span><span class="token class-name">MyOas20ConversionPipeline</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">extends</span><span class="token plain"> </span><span class="token class-name">ResolutionPipeline</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">public</span><span class="token plain"> </span><span class="token class-name">MyOas20ConversionPipeline</span><span class="token punctuation" style="color:#393A34">(</span><span class="token class-name">ErrorHandler</span><span class="token plain"> eh</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">super</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">eh</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token annotation punctuation" style="color:#393A34">@Override</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">public</span><span class="token plain"> </span><span class="token class-name">ProfileName</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">profileName</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> </span><span class="token class-name">Oas20Profile</span><span class="token plain">$</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">MODULE$</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token annotation punctuation" style="color:#393A34">@Override</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">public</span><span class="token plain"> </span><span class="token class-name">Seq</span><span class="token generics punctuation" style="color:#393A34">&lt;</span><span class="token generics class-name">ResolutionStage</span><span class="token generics punctuation" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">steps</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token class-name">List</span><span class="token generics punctuation" style="color:#393A34">&lt;</span><span class="token generics class-name">ResolutionStage</span><span class="token generics punctuation" style="color:#393A34">&gt;</span><span class="token plain"> stages </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">new</span><span class="token plain"> </span><span class="token class-name">ArrayList</span><span class="token generics punctuation" style="color:#393A34">&lt;</span><span class="token generics punctuation" style="color:#393A34">&gt;</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">    stages</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">add</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">new</span><span class="token plain"> </span><span class="token class-name">MyCustomStage</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">this</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">eh</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> </span><span class="token class-name">JavaConverters</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">asScalaBuffer</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">stages</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">public</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">class</span><span class="token plain"> </span><span class="token class-name">MyCustomStage</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">extends</span><span class="token plain"> </span><span class="token class-name">ResolutionStage</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">public</span><span class="token plain"> </span><span class="token class-name">MyCustomStage</span><span class="token punctuation" style="color:#393A34">(</span><span class="token class-name">ErrorHandler</span><span class="token plain"> errorHandler</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">super</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">errorHandler</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token annotation punctuation" style="color:#393A34">@Override</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">public</span><span class="token plain"> </span><span class="token generics punctuation" style="color:#393A34">&lt;</span><span class="token generics class-name">T</span><span class="token generics"> </span><span class="token generics keyword" style="color:#00009f">extends</span><span class="token generics"> </span><span class="token generics class-name">BaseUnit</span><span class="token generics punctuation" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token class-name">T</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">resolve</span><span class="token punctuation" style="color:#393A34">(</span><span class="token class-name">T</span><span class="token plain"> model</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> model</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div></div></article><div class="margin-vert--xl"><div class="row"><div class="col"></div><div class="col text--right"><em><small>Last updated on <time datetime="2021-02-02T17:15:40.000Z" class="docLastUpdatedAt_1Qna">2/2/2021</time> by <strong>arielmirra</strong></small></em></div></div></div><div class="margin-vert--lg"><nav class="pagination-nav" aria-label="Blog list page navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/docs/custom/resource_loaders"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">« Custom resource loaders</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/docs/related/async_raml_datatypes"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Async + RAML Data Types in AMF »</div></a></div></nav></div></div></div><div class="col col--3"><div class="tableOfContents_2xL- thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#conversion-goals" class="table-of-contents__link">Conversion Goals</a><ul><li><a href="#concepts-present-in-a-spec-but-nonexistent-in-another-arent-supported" class="table-of-contents__link">Concepts present in a spec but nonexistent in another aren&#39;t supported</a></li><li><a href="#not-all-specs-are-supported" class="table-of-contents__link">Not all specs are supported</a></li><li><a href="#information-may-be-lost" class="table-of-contents__link">Information may be lost</a></li><li><a href="#default-conversion-is-not-customizable" class="table-of-contents__link">Default conversion is not customizable</a></li><li><a href="#round-trip-conversions" class="table-of-contents__link">Round-trip conversions</a></li><li><a href="#why-dont-we-use-annotations-to-render-incompatible-content" class="table-of-contents__link">Why don&#39;t we use annotations to render incompatible content?</a></li><li><a href="#why-have-some-items-in-the-spec-lost-their-relative-order" class="table-of-contents__link">Why have some items in the spec lost their relative order?</a></li><li><a href="#can-i-parse-and-render-my-api-from-a-spec-to-the-same-one" class="table-of-contents__link">Can I parse and render my API from a spec to the same one?</a></li><li><a href="#why-do-i-have-to-use-conversion-resolution-cant-renderers-know-how-to-render-correctly" class="table-of-contents__link">Why do I have to use conversion resolution? Can&#39;t Renderers know how to render correctly?</a></li></ul></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="row footer__links"><div class="col footer__col"><h4 class="footer__title">Docs</h4><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/docs/AML/aml">Get Started</a></li></ul></div><div class="col footer__col"><h4 class="footer__title">Resources</h4><ul class="footer__items"><li class="footer__item"><a href="https://github.com/aml-org/amf-aml" target="_blank" rel="noopener noreferrer" class="footer__link-item">AML</a></li><li class="footer__item"><a href="https://github.com/aml-org/aml-spec" target="_blank" rel="noopener noreferrer" class="footer__link-item">AML Spec</a></li><li class="footer__item"><a href="https://github.com/aml-org/amf" target="_blank" rel="noopener noreferrer" class="footer__link-item">AMF</a></li></ul></div></div><div class="footer__bottom text--center"><div class="margin-bottom--sm"><img class="footer__logo" src="/img/logos/amlLogo.svg"></div><div class="footer__copyright">Copyright © 2021 Mulesoft, LLC, a Salesforce company</div></div></div></footer></div>
<script src="/styles.93fa50a3.js"></script>
<script src="/runtime~main.77570002.js"></script>
<script src="/main.42cbe68a.js"></script>
<script src="/common.f6c72066.js"></script>
<script src="/2.86439050.js"></script>
<script src="/37.da5e16ec.js"></script>
<script src="/40.8980a277.js"></script>
<script src="/935f2afb.8a573342.js"></script>
<script src="/17896441.54bdb81c.js"></script>
<script src="/a2867a9b.9ba72644.js"></script>
</body>
</html>